Using gpu device 0: GRID K520 (CNMeM is disabled)
/home/ubuntu/anaconda/lib/python2.7/site-packages/sklearn/cross_validation.py:412: Warning: The least populated class in y has only 4 members, which is too few. The minimum number of labels for any class cannot be less than n_folds=5.
  % (min_labels, self.n_folds)), Warning)
# Neural Network with 2039938 learnable parameters

## Layer information

  #  name        size
---  --------  ------
  0  input      10079
  1  dropout    10079
  2  hidden1      200
  3  dropout1     200
  4  hidden2      100
  5  dropout2     100
  6  output        38

  epoch    train loss    valid loss    train/val    valid acc  dur
-------  ------------  ------------  -----------  -----------  -----
      1       [36m3.16902[0m       [32m2.70232[0m      1.17270      0.27401  2.84s
      2       [36m2.50920[0m       [32m2.12468[0m      1.18098      0.43099  2.82s
      3       [36m2.15393[0m       [32m1.82132[0m      1.18262      0.55057  3.42s
      4       [36m1.95524[0m       [32m1.64134[0m      1.19125      0.58479  3.23s
      5       [36m1.83078[0m       [32m1.52197[0m      1.20290      0.60104  3.10s
      6       [36m1.73968[0m       [32m1.43753[0m      1.21019      0.61255  3.03s
      7       [36m1.67711[0m       [32m1.37480[0m      1.21990      0.61969  3.04s
      8       [36m1.62093[0m       [32m1.31973[0m      1.22822      0.62826  2.84s
      9       [36m1.57307[0m       [32m1.27760[0m      1.23127      0.63158  2.83s
     10       [36m1.53445[0m       [32m1.23830[0m      1.23915      0.63616  2.83s
     11       [36m1.51284[0m       [32m1.21089[0m      1.24936      0.64325  2.82s
     12       [36m1.47471[0m       [32m1.17366[0m      1.25650      0.65311  2.83s
     13       [36m1.45936[0m       [32m1.15664[0m      1.26172      0.65191  2.82s
     14       [36m1.43231[0m       [32m1.13820[0m      1.25839      0.65587  2.82s
     15       [36m1.41104[0m       [32m1.11538[0m      1.26508      0.66404  2.82s
     16       [36m1.39068[0m       [32m1.10079[0m      1.26335      0.66859  2.83s
     17       [36m1.38258[0m       [32m1.09671[0m      1.26066      0.66368  2.82s
     18       [36m1.36361[0m       [32m1.07579[0m      1.26754      0.66930  2.78s
     19       [36m1.34557[0m       [32m1.07091[0m      1.25647      0.66833  2.82s
     20       [36m1.33733[0m       [32m1.05113[0m      1.27227      0.67359  2.82s
     21       [36m1.31836[0m       [32m1.04344[0m      1.26347      0.67458  2.80s
     22       [36m1.31398[0m       [32m1.03025[0m      1.27540      0.67776  2.81s
     23       [36m1.30223[0m       [32m1.02134[0m      1.27502      0.67979  2.83s
     24       [36m1.29032[0m       [32m1.01968[0m      1.26542      0.67880  2.83s
     25       [36m1.28056[0m       [32m1.00699[0m      1.27167      0.68203  2.83s
     26       [36m1.26805[0m       [32m0.99317[0m      1.27677      0.68514  2.81s
     27       [36m1.26620[0m       [32m0.98157[0m      1.28997      0.68899  2.81s
     28       [36m1.25194[0m       0.99074      1.26364      0.68274  2.83s
     29       [36m1.24542[0m       0.98163      1.26873      0.68566  2.83s
     30       [36m1.23242[0m       [32m0.97719[0m      1.26119      0.68772  2.82s
     31       [36m1.22455[0m       [32m0.97486[0m      1.25613      0.68491  2.82s
     32       [36m1.21889[0m       [32m0.94882[0m      1.28464      0.69660  2.83s
     33       [36m1.21090[0m       0.96077      1.26034      0.69069  2.83s
     34       [36m1.20224[0m       0.95484      1.25910      0.69116  2.81s
     35       [36m1.19495[0m       [32m0.94357[0m      1.26642      0.69425  2.72s
     36       [36m1.19000[0m       0.94484      1.25948      0.69248  2.76s
     37       [36m1.18083[0m       [32m0.93980[0m      1.25647      0.69503  2.82s
     38       [36m1.17441[0m       [32m0.93821[0m      1.25175      0.69500  2.82s
     39       [36m1.16900[0m       [32m0.93038[0m      1.25649      0.69587  2.83s
     40       [36m1.16868[0m       [32m0.92242[0m      1.26696      0.69738  2.81s
     41       [36m1.15856[0m       0.92364      1.25434      0.69776  2.70s
     42       [36m1.15037[0m       [32m0.91598[0m      1.25589      0.69897  2.75s
     43       [36m1.14352[0m       [32m0.91443[0m      1.25054      0.69710  2.82s
     44       1.14435       0.91983      1.24408      0.69576  2.76s
     45       [36m1.13784[0m       [32m0.89986[0m      1.26447      0.70337  2.83s
     46       [36m1.12672[0m       0.91175      1.23577      0.69847  2.81s
     47       [36m1.12441[0m       [32m0.89687[0m      1.25371      0.70326  2.83s
     48       [36m1.11362[0m       0.90451      1.23118      0.69936  2.82s
     49       1.11403       [32m0.87770[0m      1.26926      0.71009  2.83s
     50       [36m1.11089[0m       0.88453      1.25591      0.70832  2.82s
     51       [36m1.10200[0m       0.89552      1.23056      0.70052  2.81s
     52       [36m1.09786[0m       0.88879      1.23523      0.70483  2.82s
     53       [36m1.09340[0m       0.88954      1.22918      0.70344  2.79s
     54       [36m1.07891[0m       [32m0.87192[0m      1.23738      0.70910  2.76s
     55       [36m1.07811[0m       0.87948      1.22585      0.70609  2.82s
     56       [36m1.07389[0m       0.87621      1.22561      0.70349  2.82s
     57       [36m1.06635[0m       0.87982      1.21201      0.70479  2.82s
     58       1.07003       [32m0.86609[0m      1.23547      0.70969  2.83s
     59       1.06770       0.87899      1.21468      0.70498  2.83s
     60       [36m1.05790[0m       0.87078      1.21488      0.70667  2.83s
     61       [36m1.05689[0m       [32m0.85485[0m      1.23634      0.71297  2.83s
     62       [36m1.04606[0m       0.85861      1.21831      0.71156  2.78s
     63       [36m1.04021[0m       [32m0.84471[0m      1.23144      0.71597  2.82s
     64       1.04272       0.84900      1.22817      0.71406  2.81s
     65       [36m1.03394[0m       [32m0.84080[0m      1.22971      0.71552  2.83s
     66       [36m1.03197[0m       0.85896      1.20142      0.70873  2.83s
     67       [36m1.02190[0m       0.84845      1.20443      0.71385  2.81s
     68       1.02342       0.86116      1.18842      0.70844  2.83s
     69       1.02229       [32m0.83967[0m      1.21749      0.71583  2.83s
     70       [36m1.00717[0m       0.84096      1.19765      0.71300  2.82s
     71       [36m1.00477[0m       0.84144      1.19410      0.71436  2.82s
     72       [36m1.00121[0m       [32m0.83275[0m      1.20229      0.71500  2.79s
     73       [36m0.99999[0m       [32m0.83269[0m      1.20092      0.71705  2.82s
     74       [36m0.99162[0m       0.83406      1.18891      0.71561  2.82s
     75       [36m0.98920[0m       0.83830      1.18001      0.71418  2.83s
     76       [36m0.98366[0m       [32m0.82643[0m      1.19025      0.71939  2.83s
     77       [36m0.97794[0m       [32m0.81680[0m      1.19728      0.72356  2.82s
     78       [36m0.97642[0m       0.82802      1.17922      0.71845  2.82s
     79       [36m0.97335[0m       0.83395      1.16715      0.71340  2.82s
     80       [36m0.96130[0m       0.82293      1.16815      0.71998  2.83s
     81       0.96453       [32m0.81151[0m      1.18857      0.72578  2.83s
     82       0.96248       [32m0.81143[0m      1.18615      0.72325  2.83s
     83       [36m0.95514[0m       0.82170      1.16241      0.71963  2.83s
     84       [36m0.95505[0m       0.82056      1.16389      0.72095  2.81s
     85       [36m0.95344[0m       0.81888      1.16432      0.71917  2.81s
     86       [36m0.94260[0m       0.82918      1.13679      0.71590  2.80s
     87       [36m0.93946[0m       0.81875      1.14744      0.71816  2.83s
     88       [36m0.93608[0m       [32m0.80389[0m      1.16443      0.72854  2.82s
     89       [36m0.92853[0m       [32m0.80134[0m      1.15873      0.72665  2.83s
     90       0.92941       [32m0.79165[0m      1.17402      0.73146  2.83s
     91       [36m0.92410[0m       0.80987      1.14104      0.72246  2.82s
     92       [36m0.92141[0m       0.79224      1.16305      0.73140  2.82s
     93       [36m0.91929[0m       0.80452      1.14266      0.72422  2.82s
     94       [36m0.91636[0m       0.79441      1.15351      0.73081  2.81s
     95       [36m0.90486[0m       0.79618      1.13650      0.72743  2.81s
     96       0.90829       0.80701      1.12550      0.72449  2.82s
     97       [36m0.89696[0m       [32m0.78411[0m      1.14392      0.73257  2.83s
     98       0.89772       0.78910      1.13765      0.72915  2.82s
     99       [36m0.89249[0m       0.80736      1.10545      0.72569  2.83s
    100       0.89342       0.79504      1.12374      0.72568  2.82s
    101       [36m0.88804[0m       0.79647      1.11497      0.72658  2.82s
    102       [36m0.88291[0m       0.79473      1.11096      0.72772  2.83s
    103       [36m0.87300[0m       0.78890      1.10660      0.72960  2.82s
    104       0.87638       [32m0.78089[0m      1.12229      0.73054  2.80s
    105       0.87732       0.78569      1.11662      0.72854  2.82s
    106       [36m0.87151[0m       0.78772      1.10637      0.72882  2.80s
    107       [36m0.86522[0m       0.79000      1.09521      0.72797  2.83s
    108       0.86578       0.78434      1.10383      0.73029  2.82s
    109       [36m0.86414[0m       [32m0.77530[0m      1.11459      0.73344  2.81s
    110       [36m0.85967[0m       0.80462      1.06842      0.72385  2.83s
    111       [36m0.85741[0m       0.79209      1.08246      0.72911  2.82s
    112       [36m0.84904[0m       0.79043      1.07415      0.72602  2.82s
    113       [36m0.84601[0m       [32m0.77458[0m      1.09221      0.73227  2.83s
    114       0.84640       [32m0.76576[0m      1.10531      0.73739  2.83s
    115       [36m0.84031[0m       0.77649      1.08219      0.73359  2.78s
    116       [36m0.83730[0m       0.78697      1.06395      0.72828  2.83s
    117       [36m0.83299[0m       0.79339      1.04990      0.72477  2.83s
    118       [36m0.83192[0m       [32m0.76282[0m      1.09058      0.73824  2.82s
    119       [36m0.82251[0m       0.76347      1.07734      0.73887  2.83s
    120       [36m0.82126[0m       0.78036      1.05242      0.73246  2.83s
    121       0.82250       0.77871      1.05624      0.73224  2.83s
    122       0.82250       0.77835      1.05673      0.73028  2.83s
    123       [36m0.82075[0m       0.80151      1.02402      0.72385  2.83s
    124       [36m0.81969[0m       0.77135      1.06268      0.73501  2.83s
    125       [36m0.81659[0m       0.76398      1.06885      0.73842  2.83s
    126       [36m0.81174[0m       0.77522      1.04711      0.73345  2.83s
    127       [36m0.80356[0m       0.77283      1.03976      0.73409  2.80s
    128       0.80927       [32m0.76115[0m      1.06321      0.73934  2.80s
    129       [36m0.80058[0m       0.78383      1.02137      0.73001  2.82s
    130       0.80118       0.77926      1.02812      0.73335  2.83s
    131       [36m0.79417[0m       [32m0.75768[0m      1.04817      0.73903  2.81s
    132       [36m0.78831[0m       [32m0.75431[0m      1.04507      0.74234  2.82s
    133       0.79222       0.76686      1.03307      0.73623  2.82s
    134       0.78991       [32m0.73555[0m      1.07390      0.74725  2.82s
    135       [36m0.78199[0m       0.77422      1.01004      0.73567  2.81s
    136       [36m0.78152[0m       0.77388      1.00988      0.73392  2.82s
    137       0.78230       0.77016      1.01576      0.73637  2.80s
    138       [36m0.77525[0m       0.76214      1.01720      0.73894  2.82s
    139       0.77692       0.75740      1.02577      0.74253  2.82s
    140       [36m0.77370[0m       0.75734      1.02161      0.73845  2.82s
    141       [36m0.76880[0m       0.75686      1.01578      0.74048  2.82s
    142       0.77051       0.74476      1.03458      0.74548  2.81s
    143       [36m0.76491[0m       0.74215      1.03066      0.74691  2.83s
    144       [36m0.76276[0m       0.77692      0.98177      0.73446  2.81s
    145       0.76341       0.74836      1.02011      0.74653  2.76s
    146       [36m0.75811[0m       0.74114      1.02290      0.74633  2.82s
    147       [36m0.75459[0m       0.76099      0.99160      0.74161  2.81s
    148       [36m0.74291[0m       0.75890      0.97894      0.74033  2.82s
    149       0.75283       0.74563      1.00965      0.74771  2.81s
    150       0.74672       0.76020      0.98226      0.74073  2.82s
    151       0.74491       0.74965      0.99367      0.74567  2.79s
    152       0.74714       0.75895      0.98444      0.74227  2.82s
    153       0.74650       0.76338      0.97789      0.73894  2.82s
    154       [36m0.74192[0m       0.74308      0.99844      0.74573  2.83s
    155       0.74676       0.75026      0.99533      0.74724  2.82s
    156       [36m0.73515[0m       0.74646      0.98485      0.74620  2.83s
    157       0.73710       0.75781      0.97268      0.74156  2.83s
    158       [36m0.72966[0m       0.74429      0.98034      0.74708  2.81s
    159       0.73208       0.74735      0.97957      0.74654  2.82s
Will train until validation_0 error hasn't decreased in 25 rounds.
[0]	validation_0-mlogloss:3.087958
[1]	validation_0-mlogloss:2.788968
[2]	validation_0-mlogloss:2.596730
[3]	validation_0-mlogloss:2.428819
[4]	validation_0-mlogloss:2.295958
[5]	validation_0-mlogloss:2.197903
[6]	validation_0-mlogloss:2.110904
[7]	validation_0-mlogloss:2.028487
[8]	validation_0-mlogloss:1.978688
[9]	validation_0-mlogloss:1.902804
[10]	validation_0-mlogloss:1.851207
[11]	validation_0-mlogloss:1.799757
[12]	validation_0-mlogloss:1.748831
[13]	validation_0-mlogloss:1.696897
[14]	validation_0-mlogloss:1.658268
[15]	validation_0-mlogloss:1.615114
[16]	validation_0-mlogloss:1.574637
[17]	validation_0-mlogloss:1.541015
[18]	validation_0-mlogloss:1.517099
[19]	validation_0-mlogloss:1.483323
[20]	validation_0-mlogloss:1.454768
[21]	validation_0-mlogloss:1.430858
[22]	validation_0-mlogloss:1.397205
[23]	validation_0-mlogloss:1.385488
[24]	validation_0-mlogloss:1.364789
[25]	validation_0-mlogloss:1.351980
[26]	validation_0-mlogloss:1.332208
[27]	validation_0-mlogloss:1.326491
[28]	validation_0-mlogloss:1.302510
[29]	validation_0-mlogloss:1.291994
[30]	validation_0-mlogloss:1.270946
[31]	validation_0-mlogloss:1.255797
[32]	validation_0-mlogloss:1.248069
[33]	validation_0-mlogloss:1.245021
[34]	validation_0-mlogloss:1.234955
[35]	validation_0-mlogloss:1.217330
[36]	validation_0-mlogloss:1.199782
[37]	validation_0-mlogloss:1.189026
[38]	validation_0-mlogloss:1.190577
[39]	validation_0-mlogloss:1.191583
[40]	validation_0-mlogloss:1.179586
[41]	validation_0-mlogloss:1.181097
[42]	validation_0-mlogloss:1.169612
[43]	validation_0-mlogloss:1.163073
[44]	validation_0-mlogloss:1.161917
[45]	validation_0-mlogloss:1.159324
[46]	validation_0-mlogloss:1.147200
[47]	validation_0-mlogloss:1.142360
[48]	validation_0-mlogloss:1.138002
[49]	validation_0-mlogloss:1.137737
[50]	validation_0-mlogloss:1.148885
[51]	validation_0-mlogloss:1.136348
[52]	validation_0-mlogloss:1.136574
[53]	validation_0-mlogloss:1.126311
[54]	validation_0-mlogloss:1.125468
[55]	validation_0-mlogloss:1.132463
[56]	validation_0-mlogloss:1.139426
[57]	validation_0-mlogloss:1.130615
[58]	validation_0-mlogloss:1.135303
[59]	validation_0-mlogloss:1.149952
[60]	validation_0-mlogloss:1.153524
[61]	validation_0-mlogloss:1.173462
[62]	validation_0-mlogloss:1.206045
[63]	validation_0-mlogloss:1.214764
[64]	validation_0-mlogloss:1.207632
[65]	validation_0-mlogloss:1.232488
[66]	validation_0-mlogloss:1.242436
[67]	validation_0-mlogloss:1.281381
[68]	validation_0-mlogloss:1.308912
[69]	validation_0-mlogloss:1.325516
[70]	validation_0-mlogloss:1.351657
[71]	validation_0-mlogloss:1.389652
[72]	validation_0-mlogloss:1.405210
[73]	validation_0-mlogloss:1.398276
[74]	validation_0-mlogloss:1.426280
[75]	validation_0-mlogloss:1.426677
[76]	validation_0-mlogloss:1.458178
[77]	validation_0-mlogloss:1.483530
[78]	validation_0-mlogloss:1.524489
[79]	validation_0-mlogloss:1.566838
Stopping. Best iteration:
[54]	validation_0-mlogloss:1.125468

Early stopping.
Best valid loss was 0.735551 at epoch 134.
Loaded parameters to layer 'hidden1' (shape 10079x200).
Loaded parameters to layer 'hidden1' (shape 200).
Loaded parameters to layer 'hidden2' (shape 200x100).
Loaded parameters to layer 'hidden2' (shape 100).
Loaded parameters to layer 'output' (shape 100x38).
Loaded parameters to layer 'output' (shape 38).
